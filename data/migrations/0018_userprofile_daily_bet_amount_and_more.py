# Generated by Django 5.2.4 on 2025-08-06 19:04

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('data', '0017_bet_market_volume_at_time_bet_ml_confidence_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='userprofile',
            name='daily_bet_amount',
            field=models.IntegerField(default=0, help_text='Total amount bet today'),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='daily_bet_limit',
            field=models.IntegerField(default=5000, help_text='Daily betting limit'),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='daily_bets_placed',
            field=models.IntegerField(default=0, help_text='Bets placed today'),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='is_suspended',
            field=models.BooleanField(default=False, help_text='Account suspended from betting'),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='last_bet_date',
            field=models.DateField(blank=True, help_text='Date of last bet', null=True),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='max_bet_amount',
            field=models.IntegerField(default=1000, help_text='Maximum bet amount allowed'),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='risk_tolerance',
            field=models.CharField(choices=[('CONSERVATIVE', 'Conservative'), ('MODERATE', 'Moderate'), ('AGGRESSIVE', 'Aggressive')], default='MODERATE', max_length=20),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='suspension_reason',
            field=models.TextField(blank=True, help_text='Reason for suspension'),
        ),
        migrations.AddField(
            model_name='userprofile',
            name='suspension_until',
            field=models.DateTimeField(blank=True, help_text='Suspension end date', null=True),
        ),
        migrations.CreateModel(
            name='MarketMaker',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('bet_type', models.CharField(choices=[('PODIUM_FINISH', 'Podium Finish'), ('EXACT_POSITION', 'Exact Position'), ('DNF_PREDICTION', 'DNF Prediction'), ('QUALIFYING_POSITION', 'Qualifying Position'), ('FASTEST_LAP', 'Fastest Lap'), ('HEAD_TO_HEAD', 'Head-to-Head'), ('TEAM_BATTLE', 'Team Battle'), ('SAFETY_CAR', 'Safety Car'), ('WEATHER_BET', 'Weather Bet')], max_length=20)),
                ('total_volume', models.IntegerField(default=0, help_text='Total betting volume')),
                ('total_bets', models.IntegerField(default=0, help_text='Total number of bets')),
                ('current_odds', models.FloatField(help_text='Current market odds')),
                ('base_odds', models.FloatField(help_text='Base odds without market adjustment')),
                ('available_liquidity', models.IntegerField(default=10000, help_text='Available credits for market making')),
                ('max_exposure', models.IntegerField(default=5000, help_text='Maximum exposure per bet')),
                ('spread_percentage', models.FloatField(default=0.05, help_text='Bid-ask spread as percentage')),
                ('adjustment_sensitivity', models.FloatField(default=0.1, help_text='How quickly odds adjust to volume')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('driver', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='data.driver')),
                ('event', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.event')),
                ('team', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='data.team')),
            ],
        ),
        migrations.CreateModel(
            name='MarketOrder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('order_type', models.CharField(choices=[('MARKET', 'Market Order'), ('LIMIT', 'Limit Order'), ('STOP', 'Stop Order')], max_length=10)),
                ('side', models.CharField(choices=[('BUY', 'Buy'), ('SELL', 'Sell')], max_length=4)),
                ('amount', models.IntegerField(help_text='Amount in credits')),
                ('limit_price', models.FloatField(blank=True, help_text='Limit price for limit orders', null=True)),
                ('stop_price', models.FloatField(blank=True, help_text='Stop price for stop orders', null=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('FILLED', 'Filled'), ('CANCELLED', 'Cancelled'), ('REJECTED', 'Rejected')], default='PENDING', max_length=10)),
                ('filled_amount', models.IntegerField(default=0)),
                ('average_price', models.FloatField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('filled_at', models.DateTimeField(blank=True, null=True)),
                ('market_maker', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.marketmaker')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='market_orders', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='marketmaker',
            index=models.Index(fields=['event', 'bet_type'], name='data_market_event_i_7a6316_idx'),
        ),
        migrations.AddIndex(
            model_name='marketmaker',
            index=models.Index(fields=['total_volume'], name='data_market_total_v_de65d4_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='marketmaker',
            unique_together={('event', 'bet_type', 'driver', 'team')},
        ),
        migrations.AddIndex(
            model_name='marketorder',
            index=models.Index(fields=['user', 'status'], name='data_market_user_id_a5abe7_idx'),
        ),
        migrations.AddIndex(
            model_name='marketorder',
            index=models.Index(fields=['market_maker', 'side'], name='data_market_market__cc6be9_idx'),
        ),
    ]
