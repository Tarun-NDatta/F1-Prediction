# Generated by Django 5.2.1 on 2025-07-08 15:13

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('data', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='SessionType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50)),
                ('session_type', models.CharField(max_length=20, unique=True)),
            ],
        ),
        migrations.CreateModel(
            name='TeamPerformance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('dnf_rate', models.FloatField(help_text='% of races with DNF last season')),
                ('pit_stop_avg', models.FloatField(help_text='Average pit stop time in milliseconds')),
                ('reliability_score', models.FloatField(help_text='Team reliability metric')),
            ],
        ),
        migrations.CreateModel(
            name='TrackCharacteristics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('overtaking_index', models.FloatField(help_text='Average position changes per race')),
                ('safety_car_probability', models.FloatField(help_text='Probability of safety car appearance')),
                ('rain_impact', models.FloatField(help_text='Performance impact of rain (0-1)')),
                ('avg_pit_loss', models.FloatField(help_text='Average time loss per pit stop (seconds)')),
            ],
        ),
        migrations.AlterUniqueTogether(
            name='race',
            unique_together=None,
        ),
        migrations.RemoveField(
            model_name='race',
            name='circuit',
        ),
        migrations.AddField(
            model_name='circuit',
            name='altitude',
            field=models.FloatField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='circuit',
            name='circuit_id',
            field=models.CharField(blank=True, max_length=50, null=True, unique=True),
        ),
        migrations.AddField(
            model_name='circuit',
            name='circuit_type',
            field=models.CharField(choices=[('HIGH_SPEED', 'High Speed'), ('TECHNICAL', 'Technical'), ('STREET', 'Street Circuit'), ('HYBRID', 'Hybrid')], default='HYBRID', max_length=20),
        ),
        migrations.AddField(
            model_name='circuit',
            name='latitude',
            field=models.FloatField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='circuit',
            name='longitude',
            field=models.FloatField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='driver',
            name='consistency_score',
            field=models.FloatField(blank=True, help_text='Position variance over season', null=True),
        ),
        migrations.AddField(
            model_name='driver',
            name='date_of_birth',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='driver',
            name='full_name',
            field=models.CharField(blank=True, max_length=100, null=True),
        ),
        migrations.AddField(
            model_name='driver',
            name='recent_form',
            field=models.FloatField(blank=True, help_text='Average finish position in last 5 races', null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='laps',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='points',
            field=models.FloatField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='pole_delta',
            field=models.FloatField(blank=True, help_text='Time delta to pole position in seconds', null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='position_text',
            field=models.CharField(blank=True, max_length=10, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='q1_millis',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='q2_millis',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='q3_millis',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='status',
            field=models.CharField(blank=True, max_length=50, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='time',
            field=models.DurationField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='time_millis',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='raceresult',
            name='grid_position',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='raceresult',
            name='pit_stops',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='raceresult',
            name='position_gain',
            field=models.IntegerField(blank=True, help_text='Position change from grid to finish', null=True),
        ),
        migrations.AddField(
            model_name='raceresult',
            name='time_millis',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='raceresult',
            name='tyre_stints',
            field=models.JSONField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='team',
            name='country',
            field=models.CharField(blank=True, max_length=50, null=True),
        ),
        migrations.AddField(
            model_name='team',
            name='pit_stop_avg',
            field=models.FloatField(blank=True, help_text='Average pit stop time in milliseconds', null=True),
        ),
        migrations.AddField(
            model_name='team',
            name='season_dnf_rate',
            field=models.FloatField(blank=True, help_text='Percentage of DNFs in current season', null=True),
        ),
        migrations.AddField(
            model_name='team',
            name='team_id',
            field=models.CharField(blank=True, max_length=50, null=True, unique=True),
        ),
        migrations.AlterField(
            model_name='raceresult',
            name='laps',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='raceresult',
            name='points',
            field=models.FloatField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='raceresult',
            name='position_text',
            field=models.CharField(blank=True, max_length=10, null=True),
        ),
        migrations.AlterField(
            model_name='raceresult',
            name='status',
            field=models.CharField(blank=True, max_length=50, null=True),
        ),
        migrations.CreateModel(
            name='Event',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('year', models.IntegerField()),
                ('round', models.IntegerField()),
                ('name', models.CharField(max_length=100)),
                ('date', models.DateField()),
                ('official_name', models.CharField(blank=True, max_length=200, null=True)),
                ('event_id', models.CharField(blank=True, max_length=50, null=True, unique=True)),
                ('event_format', models.CharField(choices=[('CONVENTIONAL', 'Conventional'), ('SPRINT', 'Sprint Weekend')], default='CONVENTIONAL', max_length=20)),
                ('weather_data', models.JSONField(blank=True, default=dict, help_text='Temperature, precipitation, humidity, etc.', null=True)),
                ('weather_impact', models.FloatField(blank=True, help_text='Calculated weather impact score', null=True)),
                ('circuit', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.circuit')),
            ],
        ),
        migrations.CreateModel(
            name='DriverPerformance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('moving_avg_5', models.FloatField(help_text='5-race moving average position')),
                ('qualifying_avg', models.FloatField(help_text='Average qualifying position last 5 races')),
                ('position_variance', models.FloatField(help_text='Standard deviation of finish positions')),
                ('points_per_race', models.FloatField(help_text='Average points per race in current season')),
                ('driver', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.driver')),
                ('event', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.event')),
            ],
        ),
        migrations.CreateModel(
            name='PredictionModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('version', models.CharField(max_length=20)),
                ('model_type', models.CharField(choices=[('GENERAL', 'General Prediction'), ('TRACK', 'Track-Specific'), ('QUALIFYING', 'Qualifying Predictor')], max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('metrics', models.JSONField(default=dict, help_text='MAE, RMSE, accuracy@3, accuracy@5')),
                ('feature_list', models.JSONField(default=list, help_text='List of features used in training')),
                ('is_active', models.BooleanField(default=False)),
                ('circuit', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='data.circuit')),
            ],
        ),
        migrations.CreateModel(
            name='Session',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateTimeField()),
                ('session_id', models.CharField(blank=True, max_length=50, null=True, unique=True)),
                ('air_temp', models.FloatField(blank=True, null=True)),
                ('track_temp', models.FloatField(blank=True, null=True)),
                ('humidity', models.FloatField(blank=True, null=True)),
                ('wind_speed', models.FloatField(blank=True, null=True)),
                ('wind_direction', models.FloatField(blank=True, null=True)),
                ('rain', models.BooleanField(default=False)),
                ('event', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='sessions', to='data.event')),
            ],
        ),
        migrations.CreateModel(
            name='RacePrediction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('predicted_at', models.DateTimeField(auto_now_add=True)),
                ('predictions', models.JSONField(help_text='Driver-position predictions with confidence scores')),
                ('top_3_accuracy', models.FloatField(blank=True, help_text='Actual accuracy after session completion', null=True)),
                ('event', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.event')),
                ('model', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.predictionmodel')),
                ('session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.session')),
            ],
        ),
        migrations.AlterUniqueTogether(
            name='qualifyingresult',
            unique_together=set(),
        ),
        migrations.AlterUniqueTogether(
            name='raceresult',
            unique_together=set(),
        ),
        migrations.AddField(
            model_name='qualifyingresult',
            name='session',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='data.session'),
        ),
        migrations.AddField(
            model_name='raceresult',
            name='session',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='data.session'),
        ),
        migrations.AlterUniqueTogether(
            name='qualifyingresult',
            unique_together={('session', 'driver')},
        ),
        migrations.AlterUniqueTogether(
            name='raceresult',
            unique_together={('session', 'driver')},
        ),
        migrations.AddIndex(
            model_name='raceresult',
            index=models.Index(fields=['session', 'team'], name='data_racere_session_808851_idx'),
        ),
        migrations.AddIndex(
            model_name='raceresult',
            index=models.Index(fields=['driver', 'session'], name='data_racere_driver__781293_idx'),
        ),
        migrations.AddField(
            model_name='session',
            name='session_type',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.sessiontype'),
        ),
        migrations.AddField(
            model_name='teamperformance',
            name='event',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.event'),
        ),
        migrations.AddField(
            model_name='teamperformance',
            name='team',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.team'),
        ),
        migrations.AddField(
            model_name='trackcharacteristics',
            name='circuit',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='data.circuit'),
        ),
        migrations.AddIndex(
            model_name='event',
            index=models.Index(fields=['year', 'circuit'], name='data_event_year_1697dd_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='event',
            unique_together={('year', 'round')},
        ),
        migrations.AddIndex(
            model_name='driverperformance',
            index=models.Index(fields=['driver', 'event'], name='data_driver_driver__472423_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='driverperformance',
            unique_together={('driver', 'event')},
        ),
        migrations.AlterUniqueTogether(
            name='raceprediction',
            unique_together={('session', 'model')},
        ),
        migrations.RemoveField(
            model_name='qualifyingresult',
            name='q1_time',
        ),
        migrations.RemoveField(
            model_name='qualifyingresult',
            name='q2_time',
        ),
        migrations.RemoveField(
            model_name='qualifyingresult',
            name='q3_time',
        ),
        migrations.RemoveField(
            model_name='qualifyingresult',
            name='race',
        ),
        migrations.RemoveField(
            model_name='raceresult',
            name='race',
        ),
        migrations.RemoveField(
            model_name='raceresult',
            name='time_text',
        ),
        migrations.AlterUniqueTogether(
            name='session',
            unique_together={('event', 'session_type')},
        ),
        migrations.AlterUniqueTogether(
            name='teamperformance',
            unique_together={('team', 'event')},
        ),
        migrations.AlterUniqueTogether(
            name='trackcharacteristics',
            unique_together={('circuit',)},
        ),
        migrations.DeleteModel(
            name='Race',
        ),
    ]
